{% extends "base.html" %}

{% block title %}Adicionar Funcionário - Portal de Horas{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
        <div class="card">
            <div class="card-header bg-primary text-white text-center">
                <h3 class="mb-0">
                    <i class="fas fa-user-tie me-2"></i>
                    Adicionar Novo Funcionário
                </h3>
            </div>
            <div class="card-body">
                <form method="POST">
                    <div class="mb-3">
                        <label for="nome" class="form-label">
                            <i class="fas fa-user me-2"></i>Nome Completo *
                        </label>
                        <input type="text" class="form-control" id="nome" name="nome" required 
                               placeholder="Digite o nome completo do funcionário">
                    </div>
                    
                    <div class="mb-3">
                        <label for="cargo" class="form-label">
                            <i class="fas fa-briefcase me-2"></i>Cargo *
                        </label>
                        <input type="text" class="form-control" id="cargo" name="cargo" required 
                               placeholder="Digite o cargo do funcionário">
                    </div>
                    
                    <div class="mb-3">
                        <label for="salario_mensal" class="form-label">
                            <i class="fas fa-dollar-sign me-2"></i>Salário Mensal (R$) *
                        </label>
                        <input type="number" class="form-control" id="salario_mensal" name="salario_mensal" 
                               step="0.01" min="0" required 
                               placeholder="1518.00" value="1518.00">
                        <div class="form-text">
                            <i class="fas fa-info-circle me-1"></i>
                            Digite o valor do salário mensal - o valor por hora será calculado automaticamente
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="desconto" class="form-label">
                            <i class="fas fa-minus-circle me-2"></i>Desconto Mensal (R$)
                        </label>
                        <input type="number" class="form-control" id="desconto" name="desconto" 
                               step="0.01" min="0" placeholder="0.00" value="0.00">
                        <div class="form-text">
                            <i class="fas fa-info-circle me-1"></i>
                            Valor a ser descontado do salário bruto (opcional)
                        </div>
                    </div>
                    
                    <div class="alert alert-info" role="alert">
                        <i class="fas fa-lightbulb me-2"></i>
                        <strong>Cálculo Automático:</strong>
                        <ul class="mb-0 mt-2">
                            <li>Base: 200 horas mensais (44h/semana × 4,5 semanas)</li>
                            <li>Valor hora = Salário mensal ÷ 200 horas</li>
                            <li>Horas extras: +50% sobre o valor da hora normal</li>
                        </ul>
                    </div>
                    
                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary btn-lg btn-custom">
                            <i class="fas fa-save me-2"></i>Salvar Funcionário
                        </button>
                        <a href="{{ url_for('index') }}" class="btn btn-secondary btn-custom">
                            <i class="fas fa-arrow-left me-2"></i>Voltar
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">
                    <i class="fas fa-question-circle text-info me-2"></i>
                    Como funciona o cálculo de horas extras?
                </h5>
                <ul class="list-unstyled">
                    <li><i class="fas fa-check text-success me-2"></i>Jornada normal: 8 horas por dia</li>
                    <li><i class="fas fa-check text-success me-2"></i>Horas extras: acima de 8 horas trabalhadas</li>
                    <li><i class="fas fa-check text-success me-2"></i>Valor das extras: 50% a mais que a hora normal</li>
                    <li><i class="fas fa-check text-success me-2"></i>Cálculo automático baseado na entrada e saída</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Focar no primeiro campo
    document.getElementById('nome').focus();
    
    // Validar salário mensal
    const salarioMensalInput = document.getElementById('salario_mensal');
    
    salarioMensalInput.addEventListener('input', function() {
        if (this.value < 0) {
            this.value = 0;
        }
        
        // Mostrar cálculo da hora em tempo real
        const salarioMensal = parseFloat(this.value) || 0;
        const valorHora = salarioMensal / 200;
        
        // Atualizar o texto de ajuda
        const formText = this.nextElementSibling;
        if (formText && formText.classList.contains('form-text')) {
            formText.innerHTML = `
                <i class="fas fa-info-circle me-1"></i>
                Valor por hora: R$ ${valorHora.toFixed(2)} | Base: 200h/mês | Extra: R$ ${(valorHora * 1.5).toFixed(2)}
            `;
        }
    });
    
    // Trigger inicial para mostrar o cálculo
    salarioMensalInput.dispatchEvent(new Event('input'));
});
</script>
{% endblock %}
